(defcfg
  linux-continue-if-no-devs-found yes
  process-unmapped-keys yes
  concurrent-tap-hold yes
  chords-v2-min-idle-experimental 50
)
;; keys to be used in the layers
(defsrc
   q w e r t y u i o  p
   a s d f g h j k l Ô∏î
   z x c v b n m ‚∏¥ .  ‚ÅÑ
   spc
)

(defvar
  tap-timeout 200
  hold-timeout 150
  hold-timeout-long 200
  tt $tap-timeout
  ht $hold-timeout
  htl $hold-timeout-long

  ;; skip hold in same hand
  left-hand-keys (
    q w e r t
    a s d f g
    z x c v b
  )
  right-hand-keys (
    y u i o  p
    h j k l Ô∏î
    n m ‚∏¥ .  ‚ÅÑ
  )
  lh $left-hand-keys
  rh $right-hand-keys
)

;; smoother tap-hold
(deffakekeys to-base (layer-switch base))

(deftemplate taphold (tap hold holdtime keys tobase)
  (tap-hold-release-keys
    $tt
    $holdtime
    (multi $tap $tobase)
    $hold
    $keys
  )
)

;; home? row mods
(defalias
  gobase (multi
    (layer-switch nomods)
    (on-idle-fakekey to-base tap 20)
  )
   a‚ùñ (t! taphold  a ‚Äπ‚ùñ $htl $lh @gobase)
   x‚éá (t! taphold  x ‚Äπ‚éá $ht  $lh @gobase)
   c‚åÉ (t! taphold  c ‚Äπ‚åÉ $ht  $lh @gobase)
   f‚áß (t! taphold  f ‚Äπ‚áß $ht  $lh @gobase)
   j‚áß (t! taphold  j ‚áß‚Ä∫ $ht  $rh @gobase)
   ‚∏¥‚åÉ (t! taphold  ‚∏¥ ‚åÉ‚Ä∫ $ht  $rh @gobase)
   .‚éá (t! taphold  . ‚éá‚Ä∫ $ht  $rh @gobase)
  Ô∏î‚ùñ (t! taphold Ô∏î ‚ùñ‚Ä∫ $htl $rh @gobase)

  base (layer-switch base)
  bsym (layer-switch basesym)
  bnum (layer-switch basenum)
  bmouse (layer-switch basemouse)
  bsymnum (tap-hold $tt $ht @bsym @bnum)
)

;;base layer is the first layer defined
(deflayer base
  q     w     e     r     t           y     u     i     o     p
  @a‚ùñ   s     @dnav @f‚áß   g           h     @j‚áß   k     l     @Ô∏î‚ùñ
        @x‚éá   @c‚åÉ   v     b     z     n     m     @‚∏¥‚åÉ   @.‚éá   @bsymnum
                               @spc
)
(deflayer basesym (t! sym @base @bnum @bmouse))
(deflayer basenum (t! num @base @bsym))
(deflayer basemouse (t! mouse @base))

(deflayer nomods
  q     w     e     r     t           y     u     i     o     p
  a     s     d     f     g           h     j     k     l    Ô∏î
        x     c     v     b     z     n     m     ‚∏¥     .     ‚ÅÑ
                                ‚ê£
)

(defalias
  misc (layer-switch misc)
  dnav (tap-hold-release $tt $ht  (multi d @gobase) (layer-while-held nav))
  raise (tap-hold-press  $tt $ht (multi ‚ê£ @gobase) (layer-while-held raise))
  spc (fork @raise ‚ê£ (‚Äπ‚åÉ ‚åÉ‚Ä∫))
)

(deflayer raise
  @tab  ‚Ä¢     ‚Ä¢    ‚Ä¢    ‚Ä¢       ‚Ä¢    ‚Ä¢    ‚Ä¢    ‚Ä¢    ‚å¶
  ‚éã     ‚Ä¢    ‚Äπ‚åÉ    ‚èé    ‚Ä¢       ‚Ä¢    ‚Ä¢    ‚Ä¢    ‚Ä¢    ‚å´
        @cw   ‚Ä¢    ‚Ä¢    ‚Ä¢   ‚á™   ‚Ä¢    ‚Ä¢    ‚ÅÑ   @?    _
                            _
)
(defalias
  tab (tap-hold $tt $ht ‚≠æ  ‚Äπ‚áß‚≠æ )
  cw (caps-word-toggle 2000)
)
(deflayer nav
  ‚Äπ‚ùñq   ‚Äπ‚éá  ‚Ä¢    ‚Ä¢     ‚Ä¢          ‚Ä¢    ‚Ä¢     ‚Ä¢     ‚Äπ‚ùño   ‚å´
  ‚Äπ‚ùñ    ‚Äπ‚åÉ  ‚Ä¢    ‚Äπ‚áß    ‚Ä¢          ‚Ä¢    ‚óÄ     ‚ñº     ‚ñ≤     ‚ñ∂
        ‚Ä¢   ‚Ä¢    ‚Äπ‚ùñ‚èé   ‚Ä¢    ‚Ä¢     ‚Ä¢    ‚Üñ     ‚áü     ‚áû     ‚Üñ
                          @spc
)

(deftemplate sym (base num mouse)
  $base @‚ü®    @‚ü©    @_    @|          @Àú    @‚üß    @‚ü¶    @‚àó     @?
  @!     ‚Äê    @Ôºã    ‚Çå    @ÔºÜ         @‚åó    @„Äï  @„Äî    @‚Äô     $mouse
         Àã    @‚Äù     ‚ÅÑ     \     @‚àß   @Ôº†   @‚ùµ    @‚ù¥    @$     $num
                               @spc
)

(defalias
  !  S-1
  Ôº† S-2
  ‚åó  S-3
  $  S-4
  %  S-5
  ‚àß  S-6
  ÔºÜ S-7
  ‚àó  S-8
 „Äî  S-9
  „Äï S-0
  Àú  S-Àã
  -  min
  _  S-min
  =  eql
  Ôºã S-eql
  |  S-\
  ‚ü¶  [
  ‚üß  ]
  ‚ù¥  S-[
  ‚ùµ  S-]
  :  S-;
  ‚ü®  S-,
  ‚ü©  S-.
  ?  S-‚ÅÑ
  ‚Äù  S-'
  ‚Äô  '
)

(deftemplate num (base sym)
  $base f10   f11   f12   ‚Äê           ‚ÅÑ     @4    @5    @6    bspc
  ‚Äπ‚ùñ    ‚Äπ‚éá    ‚Äπ‚åÉ    ‚Äπ‚áß   @Ôºã          ‚Ä¢     @1    @2    @3    ‚Çå
        @misc  ‚Ä¢    0     .     ‚Ä¢     ‚∏¥     @7    @8    @9    $sym
                               @spc
)

(defalias
  1 (tap-hold $tt $ht 1 f1)
  2 (tap-hold $tt $ht 2 f2)
  3 (tap-hold $tt $ht 3 f3)
  4 (tap-hold $tt $ht 4 f4)
  5 (tap-hold $tt $ht 5 f5)
  6 (tap-hold $tt $ht 6 f6)
  7 (tap-hold $tt $ht 7 f7)
  8 (tap-hold $tt $ht 8 f8)
  9 (tap-hold $tt $ht 9 f9)
)

(deftemplate mouse (base)
  $base @mwl  @mu   @mwr  ‚Ä¢         ‚Ä¢     @prv  @nxt  mlft  ‚Ä¢
  ‚Ä¢     @ml   @md   @mr   ‚Ä¢         ‚Ä¢     ‚áß‚Ä∫    ‚åÉ‚Ä∫    ‚éá‚Ä∫    ‚ùñ‚Ä∫
        mrgt  @mwu  @mwd  ‚Ä¢    ‚Ä¢    mlft  @ma2  @ma1  @ma3  @ma0
                               _
)
(defalias
  nxt C-tab
  prv C-S-tab
  ;; mousewheel: interval, distance
  mwu (üñ±‚ò∏‚Üë 50 120)
  mwd (üñ±‚ò∏‚Üì 50 120)
  mwl (üñ±‚ò∏‚Üê 50 120)
  mwr (üñ±‚ò∏‚Üí 50 120)

  ;; movemouse-speed: percent
  ma0 (üñ±speed 25)
  ma1 (üñ±speed 50)
  ma2 (üñ±speed 150)
  ma3 (üñ±speed 250)

  ;; movemouse: interval, distance
  mu (üñ±‚Üë 8 4)
  md (üñ±‚Üì 8 4)
  ml (üñ±‚Üê 8 4)
  mr (üñ±‚Üí 8 4)
)

(deflayer misc
  @base ‚óÄ‚óÄ    ‚ñ∂‚è∏   ‚ñ∂‚ñ∂    prnt    @qwr @grp ‚Ä¢    ‚Ä¢   ‚Ä¢
  ‚Ä¢     üîà‚äñ   üîà‚ì™  üîà‚äï   ‚Ä¢       ‚Ä¢    ‚Ä¢    ‚Ä¢    ‚Ä¢   ‚Ä¢
        üîÖ    ‚Ä¢    üîÜ    ‚Ä¢   ‚Ä¢   ‚Ä¢    ‚Ä¢    ‚Ä¢    ‚Ä¢   ‚Ä¢
                             _
)

(defalias
  qwr   (layer-switch qwerty)
  grp   (layer-switch graphite-nomod)
  oneshot-sym (one-shot 1000 (layer-toggle basesym))
  ‚ÅÑ (tap-hold $tt 1000 @oneshot-sym (layer-switch base))
)
(deflayer qwerty
  q     w     e     r     t           y     u     i     o     p
  a     s     d     f     g           h     j     k     l    Ô∏î
  z     x     c     v     b           n     m     ‚∏¥     .    @‚ÅÑ
                                ‚ê£
)

(deffakekeys to-graphite (layer-switch graphite))
(defalias
  gograph (multi
    (layer-switch graphite-nomod)
    (on-idle-fakekey to-graphite tap 20)
  )
   n‚ùñg (t! taphold n ‚Äπ‚ùñ $htl $lh @gograph)
   l‚éág (t! taphold l ‚Äπ‚éá $ht  $lh @gograph)
   d‚åÉg (t! taphold d ‚Äπ‚åÉ $ht  $lh @gograph)
   s‚áßg (t! taphold s ‚Äπ‚áß $ht  $lh @gograph)
   h‚áßg (t! taphold h ‚áß‚Ä∫ $ht  $rh @gograph)
   o‚åÉg (t! taphold o ‚åÉ‚Ä∫ $ht  $rh @gograph)
   u‚éág (t! taphold u ‚éá‚Ä∫ $ht  $rh @gograph)
   i‚ùñg (t! taphold i ‚ùñ‚Ä∫ $htl $rh @gograph)
  tnav (tap-hold-release $tt $ht  (multi t @gograph) (layer-while-held nav))
   ‚Äò (fork @‚Äô  @_ (‚Äπ‚áß ‚áß‚Ä∫)) ;; S-' -> _
   ‚∏¥ (fork  ‚∏¥  @‚Äù (‚Äπ‚áß ‚áß‚Ä∫)) ;; S-, -> "
   . (fork  .  Ô∏î (‚Äπ‚áß ‚áß‚Ä∫)) ;; S-. -> ;
)
(deflayer graphite
   b    @l‚éág  @d‚åÉg    w     z         @‚Äò     f    @o‚åÉg  @u‚éág   j
  @n‚ùñg   r    @tnav @s‚áßg    g          y    @h‚áßg   a     e    @i‚ùñg
         x     m      c     v    q     k     p    @.    @‚∏¥    @‚ÅÑ
                                ‚ê£
)
(deflayer graphite-nomod
   b     l     d     w     z         @‚Äò     f     o     u     j ;; ; =
   n     r     t     s     g          y     h     a     e     i ;; -
         x     m     c     v    q     k     p    @.    @‚∏¥    @‚ÅÑ
                                ‚ê£
)
